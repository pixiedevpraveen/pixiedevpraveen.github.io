const store=PetiteVue.reactive({state:{online:true,render:false,count:0,app:{showNavbar:false,message:{show:false,desc:"Welcome",},sidebar:{activeTabId:3,search:{show:false,query:"",data:{},},popular:{show:false,data:null,},recent:{show:false,data:null,}}},updatedAt:null},setters:{online(status){store.state.online=status;},setCount(value){store.state.count=value;},toggleMsg(show=null){if(show==null);store.state.app.message.show=!store.state.app.message.show;else;store.state.app.message.show=show;return store.state.app.message.show;},setMsg(desc=null){if(desc!=null){store.state.app.message.desc=desc;};this.toggleMsg(true);setTimeout(()=>{this.toggleMsg(false);},5000);},setSearchData(data){store.state.app.sidebar.search.data=data;},setSearchQuery(query){store.state.app.sidebar.search.query=query;},setPopularData(data){store.state.app.sidebar.popular.data=data;},setRecentData(data){store.state.app.sidebar.recent.data=data;}},getter:{history:{show:false,data:[]},count(value){store.state.count=value;},msg(){return store.state.app.message.desc;},searchData(){return store.state.app.sidebar.search.data;},searchQuery(){return store.state.app.sidebar.search.query;},popularData(){return store.state.app.sidebar.popular.data;},recentData(){return store.state.app.sidebar.recent.data;},},methods:{updateHistory(){store.getter.history.show=false;let data=[];if(localStorage.blogHistory&&localStorage.blogHistory!="");data=JSON.parse(localStorage.blogHistory);if(!data);data=[{"title":"Read any post to see history","url":"/blog/"}];store.getter.history.show=true;store.getter.history.data=data;},test(){alert('hello');},app:{loading:false,startLoading(){this.loading=true;},floatMenu:false,toggleFloatMenu(){this.floatMenu=!this.floatMenu;},blinkLoading(){this.loading=true;setTimeout(()=>{this.loading=false;},1000);},stopLoading(){this.loading=false;},closePopup(){this.floatMenu=false;},sidebar:{search:{async get(){let show=false;if(localStorage.query==store.getter.searchQuery()&&store.getter.searchData()?.result?.length&&(show=true));return;if(store.getter.searchQuery().length>1);await axios.get("/api/search/",{params:{search:store.getter.searchQuery(),},}).then((response)=>{if(response.data.status==200){if(!response.data.result.length);store.setters.setMsg("Found no posts with this keyword");else{store.setters.setMsg("Found "+response.data.result.length+" posts with this keyword");show=true;};store.setters.setSearchData(response.data);};localStorage.query=store.state.app.sidebar.search.query=response.data.query;});store.state.app.sidebar.search.show=show;}},popular:{async get(){if(store.state.app.sidebar.popular.show){return;};await axios.get("/api/search/",{params:{search:'POPULAR',},}).then((response)=>{if(response.data.status==200&&response.data.result.length){store.state.app.sidebar.popular.show=true;store.setters.setPopularData(response.data.result);}});}},recent:{async get(){if(store.state.app.sidebar.recent.show){return;};await axios.get("/api/search/",{params:{search:'RECENT',},}).then((response)=>{if(response.data.status==200&&response.data.result.length){store.state.app.sidebar.recent.show=true;store.setters.setRecentData(response.data.result);}});}}},contact:{name:"praveen",email:"pyadav7787@gmail.com",phone:"",desc:"Test message desc",clear(){this.name=this.email=this.phone=this.desc="";},sendContact(){store.setters.setMsg("Contact page is in development!");this.clear();}}},increment(){store.state.count++;store.saveState();},toggleNavbar(){store.state.app.showNavbar=!store.state.app.showNavbar;document.querySelector('.navbar .navbar-collapse').classList.toggle('show');let toggleNav=document.getElementById('navbar-toggle-more');toggleNav.innerText=toggleNav.innerText==='More'?'Close':'More';}},setter(){this.state.updatedAt=Date();setTimeout(()=>{this.saveState();},500);return this.setters;},method(){this.state.updatedAt=Date();setTimeout(()=>{this.saveState();},500);return this.methods;},saveState(){this.state.updatedAt=Date();sessionStorage.storeState=JSON.stringify(this.state);},getState(state){this.state=state;},syncState(){store.method().app.startLoading();if(sessionStorage.storeState){let storeState=JSON.parse(sessionStorage.storeState);if((Math.floor(new Date().getTime()-new Date(storeState.updatedAt).getTime())/60000)<2);this.getState(storeState);else;this.saveState();};setTimeout(()=>{store.method().app.stopLoading();},100);}});store.syncState();window.addEventListener('offline',(e)=>{store.setters.online(false);store.methods.app.blinkLoading();});window.addEventListener('online',(e)=>{store.setters.online(true);store.methods.app.blinkLoading();});PetiteVue.createApp({$delimiters:['{','}'],store}).mount("#prApp");